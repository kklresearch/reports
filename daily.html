<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbydf2nWMybXOOpNeyA2ggBZHgCzga5G4L-zH8joRW86ZkMWOWTrpXyogHGH2dHSJNDu/exec';

  function submitForm() {
    const empId = document.getElementById('empId').value.trim();
    const date = document.getElementById('entryDate').value;
    const work = document.getElementById('workDone').value.trim();

    if (!empId || !date || !work) {
      alert('Please fill out all fields.');
      return;
    }

    const formData = new FormData();
    formData.append('EmployeeID', empId);
    formData.append('Date', date);
    formData.append('WorkDone', work);
    formData.append('sheet', 'DailyReports'); // Make sure tab name in Sheet is exactly this

    fetch(scriptURL, {
      method: 'POST',
      body: formData
    })
    .then(response => response.text())
    .then(text => {
      console.log('Response from script:', text);
      if (text.toLowerCase().includes('success') || text.includes('ok') || text.includes('Web App')) {
        alert('Submitted successfully!');
        resetForm();
      } else {
        alert('Form submitted, but no confirmation from server. Please check the sheet.');
      }
    })
    .catch(error => {
      console.error('Submission error:', error);
      alert('Something went wrong. Please try again later.');
    });
  }

  function resetForm() {
    document.getElementById('empId').value = '';
    document.getElementById('entryDate').value = '';
    document.getElementById('workDone').value = '';
  }
</script>
